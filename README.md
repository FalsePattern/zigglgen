# zigglgen 0.1

Zig OpenGL binding generator

## Usage

[zigglgen runs in your web browser and is available online](https://castholm.github.io/zigglgen). Simply select an API,
version and profile and extensions and choose *Preview* or *Download* to generate a Zig binding. (Do note that zigglgen
currently only supports the nightly 0.11.0-dev builds of Zig and that generated code might not work with earlier
versions of the compiler.)

Functions, constants, types and extensions are stripped off their `^(gl|GL_?)` prefixes and have their capitalization
altered slightly but are otherwise identical to their original C/C++ definitions.

|Original C/C++         |Generated Zig                 |
|-----------------------|------------------------------|
|`glClearColor()`       |`clearColor()`                |
|`GL_TRIANGLES`         |`TRIANGLES`                   |
|`GLfloat`              |`Float`                       |
|`GL_ARB_compute_shader`|`Extension.ARB_compute_shader`|

After downloading the generated source file, run `zig fmt` on it to remove unnecessary `@""` from identifiers.

### Initialization

Before the binding can be used, it must be initialized by calling `pub fn init(loader: anytype) !void` while the calling
thread has a current OpenGL context.

`loader` must be an instance, or a pointer to an instance, of a type that declares the functions

- `pub fn getCommandFnPtr(loader: LoaderRef, command_name: [:0]const u8) !CommandFnPtr` and
- `pub fn extensionSupported(loader: LoaderRef, extension_name: [:0]const u8) !bool` (if the binding was generated with
  extensions),

where

- `LoaderRef` is equivalent to `@This()`, `*@This()` or `*const @This()` and
- `CommandFnPtr` is a function pointer type that can be coerced to `*const anyopaque`.

It is safe for the caller to free `loader` after this function returns.

### Extensions

Extension-specific functions, constants and types are made available as top-level declarations like any other. If the
binding was generated with extensions, you can call `pub fn extensionSupported(extension: Extension) bool` to test
whether an extension is supported by the current OpenGL context before attempting to use it.

## Example

Using [mach/glfw](https://github.com/hexops/mach-glfw) and a binding generated with *OpenGL 3.3 (Core Profile)* and
*NV_scissor_exclusive* selected:

```zig
const glfw = @import("glfw");
const gl = @import("gl");

pub fn main() !void {
    if (!glfw.init(.{})) return error.InitFailed;
    defer glfw.terminate();

    const window = glfw.Window.create(640, 480, "OpenGL is a art", null, null, .{
        .context_version_major = 3,
        .context_version_minor = 3,
        .opengl_profile = .opengl_core_profile,
        .opengl_forward_compat = true,
    }) orelse return error.InitFailed;
    defer window.destroy();
    glfw.makeContextCurrent(window);

    try gl.init(struct {
        pub fn getCommandFnPtr(_: @This(), command_name: [:0]const u8) !*const anyopaque {
            return glfw.getProcAddress(command_name) orelse error.InitFailed;
        }
        pub fn extensionSupported(_: @This(), extension_name: [:0]const u8) !bool {
            return glfw.extensionSupported(extension_name);
        }
    }{});

    while (!window.shouldClose()) {
        glfw.pollEvents();

        gl.disable(gl.SCISSOR_TEST);
        if (gl.extensionSupported(.NV_scissor_exclusive)) {
            gl.disable(gl.SCISSOR_TEST_EXCLUSIVE_NV);
            gl.clearColor(1, 0.8, 0.2, 1);
            gl.clear(gl.COLOR_BUFFER_BIT);
            gl.enable(gl.SCISSOR_TEST_EXCLUSIVE_NV);
            gl.scissorExclusiveNV(72, 56, 8, 8);
        }
        gl.clearColor(1, 1, 1, 1);
        gl.clear(gl.COLOR_BUFFER_BIT);
        gl.enable(gl.SCISSOR_TEST);
        gl.clearColor(0, 0, 0, 1);
        const magic: u256 = 0x1FF8200446024F3A8071E321B0EDAC0A9BFA56AA4BFA26AA13F20802060401F8;
        var i: gl.Int = 0;
        while (i < 256) : (i += 1) {
            if (magic >> @intCast(u8, i) & 1 != 0) {
                gl.scissor(@rem(i, 16) * 8 + 8, @divTrunc(i, 16) * 8 + 8, 8, 8);
                gl.clear(gl.COLOR_BUFFER_BIT);
            }
        }

        window.swapBuffers();
    }
}
```

## Licence

zigglgen is licensed under [MIT](LICENSE.md). Dependencies in the [`deps`](deps) directory may be licensed under
different terms.

zigglgen itself does not impose any restrictions on generated code, but because it derives its output from definitions
from the [OpenGL XML API Registry](deps/gl.xml), **generated code is subject to
[Apache-2.0](deps/LICENSE-Apache-2.0.txt)**. If you intend to distribute any work that uses code generated by zigglgen,
you may be required to include

- a copy of Apache-2.0 and
- a copy of the NOTICE text that is included as a comment header in the generated code

with its distribution.

## Acknowledgments and Prior Works

- [KhronosGroup/OpenGL-Registry](https://github.com/KhronosGroup/OpenGL-Registry)
- [Dav1dde/glad](https://github.com/Dav1dde/glad)
- [MasterQ32/zig-opengl](https://github.com/MasterQ32/zig-opengl)
- [linkpy/zig-gl-loader](https://github.com/linkpy/zig-gl-loader)
